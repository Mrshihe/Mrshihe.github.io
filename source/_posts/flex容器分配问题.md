---
title: flex容器分配问题
date: 2019-03-20 12:07:29
tags:
  - css
---
### flex让自使用布局变得比较简单,本文记录一下flex如何分配空间
***本文所有情况只适用与flex-basis不为auto的情况,flex-basis为auto的时候,情况比较复杂***
<!-- more -->
```
flex: 0 1 aut0;  //默认值 等价于flex-grow,flex-shrink,flex-basis的简写,后两个参数可选
```
flex-grow 定义项目的放大比例,默认为0,如果存在空间,也不放大
flex-shrink 定义项目的缩小比例,默认为1,如果空间不足,则缩小项目，为0则不缩小项目
其值我们统称为权重

#### 一.关于flex-grow的分配方式
*1.所有子项目flex-grow之和大于的1的情况*
假定容器宽度为300px,其三个子项目宽度和flex-grow分别为 100px/1 150px/2 100px/3
此时剩余的可分配空间为 150px,那么每个子项目可得的空间如下
- 150*1/6 = 25px
- 150*2/6 = 50px
- 150*3/6 = 75px

也就是说剩余的150px的空间被三个子元素分成了6份(1+2+3/flex-grow相加之和),其子元素分别占有1/6,2/6,3/6
那么此时三个子元素的宽度为

- 100 + 25 = 125px
- 150 + 50 = 200px
- 100 + 75 = 175px

*2.所有子项目flex-grow之和小于等于1的情况*
假定容器宽度为300px,其三个子项目宽度和flex-grow分别为 100px/0.1 150px/0.2 100px/0.3
此时剩余的可分配空间为 150px,那么每个子项目可得的空间如下
- 150*0.1/1 = 15px
- 150*0.2/1 = 30px
- 150*0.3/1 = 45px

此时每个子元素的宽度为(容器仍有宽度未被分配,如果flex-grow相加等于1则空间正好分配完毕)
- 100 + 15 = 115px
- 150 + 30 = 180px
- 100 + 45 = 145px

#### 二.关于flex-shrink的分配方式
##### 子项目搜索除了受flex-shrink影响外,还会受到其自身宽度影响
*1.所有子项目flex-shrink之和大于1的情况*
假定容器宽度为500px,其三个子项目宽度和flex-shrink分别为 150px/1 200px/2 300px/3
此时溢出的宽度为 150 + 200 + 300 — 500 = 150px,那么每个子项目的收缩空间如下
- 150 * 1 * 150/1450 = 15.5
- 150 * 2 * 200/1450 = 41.4
- 150 * 3 * 300/1450 = 93.1

也就是说每个子元素的收缩空间为 溢出宽度 * flex-shrink * 子元素自身宽度 / 总权重(1 * 150 + 2 * 200 + 3 * 300)
总权重等于每个子元素flex-shrink * 自身宽度相加之和
那么此时的子元素的宽度为
- 150 - 15.5 = 134.5
- 200 - 41.4 = 158.6
- 300 - 93.1 = 206.9
*1.所有子项目flex-shrink之和小于1的情况，唉,又麻烦了*
假定容器宽度为500px,其三个子项目宽度和flex-shrink分别为 150px/0.1 200px/0.2 300px/0.3
此时溢出的宽度为 150 + 200 + 300 — 500 = 150px,那么每个子项目的收缩空间如下
- 90 * 0.1 * 150/145 = 9.31
- 90 * 0.2 * 200/145 = 24.83
- 90 * 0.3 * 300/145 = 55.86
此时也就是说现在得收缩值不是溢出的150了,而是变成了150*(0.1+0.2+.03)/1 = 90,相当于只收缩了60%
所以此时的子元素宽度为
- 150 - 9.31 = 140.69
- 200 - 24.83 = 175.17
- 300 - 55.86 = 244.14

***所有数值保留位数不精准,所以跟浏览器实际宽度会有一点出入***
##### flex-grow 还受到max-width影响,flex-shrink 还受到min-width影响
[参考文章](https://zhuanlan.zhihu.com/p/24372279)

